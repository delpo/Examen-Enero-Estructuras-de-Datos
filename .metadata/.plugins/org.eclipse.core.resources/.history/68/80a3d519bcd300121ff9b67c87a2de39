package ej4;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map.Entry;
import java.util.TreeSet;

import javax.jws.Oneway;

import ej3.DoubleLinkedList;

public class EleccionesGenerales {
	
	public class VotosDePartido{
		private String partido;
		private int votos;
		
		public VotosDePartido(){}
		
		public VotosDePartido(String partido, int votos){
			this.partido = partido;
			this.votos = votos;
		}
		
		public String getPartido(){
			return partido;
		}
		
		public int getVotos(){
			return votos;
		}
		
		public void setPartido(String partido){
			this.partido = partido;
		}
		
		public void setVotos(int votos){
			this.votos = votos;
		}
	}
	
	private HashMap<String, TreeSet<VotosDePartido>> datos;
	
	public EleccionesGenerales(){
		datos  = new HashMap<String, TreeSet<VotosDePartido>>();
	}
	
	public void IncluirProvincia(String provincia){
		TreeSet<VotosDePartido> votos = new TreeSet<VotosDePartido>();
		votos.add(new VotosDePartido(provincia, 0));
		if(!datos.containsKey(provincia))
			datos.put(provincia, votos);
	}
	
	public void VotosPartido(String provincia, String partido, int votos){
		for (VotosDePartido midato : datos.get(provincia)) {
			if(midato.getPartido().equals(partido))
				midato.setVotos(votos);
		}
	}
	
	public void MostrarVotosProvincia(String provincia){
		for (VotosDePartido entry : datos.get(provincia)) {
			System.out.println("Partido : " + entry.getPartido() + " Votos : "
				+ entry.getVotos());
		}
	}
	
	public int VotosTotal(String partido){
		int votos = 0;
		for (Entry<String, TreeSet<VotosDePartido>> entry : datos.entrySet()) {
			for (VotosDePartido entry2 : entry.getValue()) {
				if(entry2.getPartido().equals(partido)){
					votos += entry2.getVotos();
				}
			}
			
		}
		return votos;
	}
	
	public Collection<Integer> TodosTotales(){
		Collection<Integer> coleccion = new DoubleLinkedList<Integer>();
		TreeSet<VotosDePartido> partidos = obtenerPartidos();
		for (VotosDePartido entry : partidos) { //para cada partido
			for (Entry<String, TreeSet<VotosDePartido>> entry2 : datos.entrySet()) { //miro cada provincia
				if(entry2.getValue().contains(entry)){
					for(VotosDePartido mipartido : entry2.getValue()){
						if(mipartido.getPartido().equals(entry)){
							int valor = entry.getVotos() + mipartido.getVotos();
							entry.setVotos(valor);							
						}
					}
				}
			}
		}
		for (VotosDePartido entry : partidos) {
			coleccion.add(entry.getVotos());
		}
		return coleccion;
		
	}
	public Collection<String> TodosPartidos(){
		Collection<String> coleccion = new DoubleLinkedList<String>();
		TreeSet<VotosDePartido> partidos = obtenerPartidos();
		for (VotosDePartido entry : partidos) {
			coleccion.add(entry.getPartido());
		}
		return coleccion;
		
	}
	
	private TreeSet<VotosDePartido> obtenerPartidos(){
		TreeSet<VotosDePartido> partidos = new TreeSet<VotosDePartido>();
		//obtengo todos los partidos
		for (Entry<String, TreeSet<VotosDePartido>> entry : datos.entrySet()) {
			for (VotosDePartido entry2 : entry.getValue()) {
				if(!partidos.contains(entry)){
					partidos.add(entry2);
				}
			}
		}
		return partidos;
	}
}
